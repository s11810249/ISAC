<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>網站後台管理系統 | 東海大學實習中心</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
<script>
tailwind.config = {
theme: {
extend: {
colors: {
thuBlue: '#002E5D',
thuLightBlue: '#eef6fc',
thuGold: '#C6A87C',
darkBg: '#0f172a',
btnGreen: '#219653',
btnGreenHover: '#1e874b',
                        // === 新增自定義識別色 ===
                        lapisYellow: '#E89B00',   // 琉璃黃
                        concreteGrey: '#A6A9AA',  // 清水灰
                        brickRed: '#A14332',      // 磚瓦紅
                        windowBlack: '#2B2B2B',   // 窗框黑
                        acaciaGreen: '#4A6B3E',   // 相思綠
                        milkWhite: '#F4F1EA',     // 鮮乳白
                        lakeBlue: '#365C68',      // 湖心藍
                        phoenixOrange: '#FF5A45', // 鳳凰橘
                        gloryGold: '#E8B72D',     // 榮耀金
                        thuBlueNew: '#005596',    // 東海藍
                        grassGreen: '#219653',    // 青草綠
},
fontFamily: {
sans: ['"Noto Sans TC"', 'sans-serif'],
@@ -478,18 +490,18 @@
function renderCardsList() {
const container = document.getElementById('cards-list-editor'); if(!container) return; container.innerHTML = '';
currentData.cards.forEach((card, index) => {
                container.innerHTML += `<div class="card-item bg-white p-5 rounded-xl shadow-sm border border-gray-200 group relative" data-index="${index}"><div class="drag-handle absolute top-0 left-0 right-0 h-6 bg-gray-100 rounded-t-xl cursor-grab flex items-center justify-center hover:bg-gray-200 transition"><i class="fas fa-grip-lines text-gray-400"></i></div><div class="mt-4 grid grid-cols-2 gap-4"><div><label class="block text-xs font-bold text-gray-400">標題</label><input type="text" class="card-title w-full border rounded p-2 text-sm font-bold text-thuBlue" value="${card.Title}"></div><div><label class="block text-xs font-bold text-gray-400">標籤</label><input type="text" class="card-badge w-full border rounded p-2 text-sm text-thuGold" value="${card.Badge||''}"></div><div class="col-span-2"><label class="block text-xs font-bold text-gray-400">描述</label><input type="text" class="card-desc w-full border rounded p-2 text-sm" value="${card.Description}"></div><div><label class="block text-xs font-bold text-gray-400">Icon</label><input type="text" class="card-icon w-full border rounded p-2 text-sm font-mono text-gray-500" value="${card.Icon}"></div><div><label class="block text-xs font-bold text-gray-400">類型</label><select class="card-type w-full border rounded p-2 text-sm"><option value="thu" ${(!card.Type||card.Type==='thu')?'selected':''}>預設藍</option><option value="gold" ${card.Type==='gold'?'selected':''}>金色</option><option value="blue" ${card.Type==='blue'?'selected':''}>天藍</option><option value="green" ${card.Type==='green'?'selected':''}>綠色</option><option value="orange" ${card.Type==='orange'?'selected':''}>橘色</option><option value="purple" ${card.Type==='purple'?'selected':''}>紫色</option><option value="red" ${card.Type==='red'?'selected':''}>紅色</option></select></div><div class="col-span-2"><label class="block text-xs font-bold text-gray-400">連結</label><input type="text" class="card-link w-full border rounded p-2 text-sm font-mono text-blue-600" value="${card.Link}"></div></div><button onclick="deleteCardItem(${index})" class="absolute top-2 right-2 text-red-400 hover:text-red-600 p-1"><i class="fas fa-trash"></i></button></div>`;
                container.innerHTML += `<div class="card-item bg-white p-5 rounded-xl shadow-sm border border-gray-200 group relative" data-index="${index}"><div class="drag-handle absolute top-0 left-0 right-0 h-6 bg-gray-100 rounded-t-xl cursor-grab flex items-center justify-center hover:bg-gray-200 transition"><i class="fas fa-grip-lines text-gray-400"></i></div><div class="mt-4 grid grid-cols-2 gap-4"><div><label class="block text-xs font-bold text-gray-400">標題</label><input type="text" class="card-title w-full border rounded p-2 text-sm font-bold text-thuBlue" value="${card.Title}"></div><div><label class="block text-xs font-bold text-gray-400">標籤</label><input type="text" class="card-badge w-full border rounded p-2 text-sm text-thuGold" value="${card.Badge||''}"></div><div class="col-span-2"><label class="block text-xs font-bold text-gray-400">描述</label><input type="text" class="card-desc w-full border rounded p-2 text-sm" value="${card.Description}"></div><div><label class="block text-xs font-bold text-gray-400">Icon</label><input type="text" class="card-icon w-full border rounded p-2 text-sm font-mono text-gray-500" value="${card.Icon}"></div><div><label class="block text-xs font-bold text-gray-400">類型</label><select class="card-type w-full border rounded p-2 text-sm"><option value="thu" ${(!card.Type||card.Type==='thu')?'selected':''}>預設藍 (THU Blue)</option><option value="thubluenew" ${card.Type==='thubluenew'?'selected':''}>東海藍 (THU New)</option><option value="glorygold" ${card.Type==='glorygold'?'selected':''}>榮耀金 (Glory Gold)</option><option value="phoenixorange" ${card.Type==='phoenixorange'?'selected':''}>鳳凰橘 (Phoenix Orange)</option><option value="brickred" ${card.Type==='brickred'?'selected':''}>磚瓦紅 (Brick Red)</option><option value="lapisyellow" ${card.Type==='lapisyellow'?'selected':''}>琉璃黃 (Lapis Yellow)</option><option value="acaciagreen" ${card.Type==='acaciagreen'?'selected':''}>相思綠 (Acacia Green)</option><option value="lakeblue" ${card.Type==='lakeblue'?'selected':''}>湖心藍 (Lake Blue)</option><option value="concretegrey" ${card.Type==='concretegrey'?'selected':''}>清水灰 (Concrete Grey)</option><option value="windowblack" ${card.Type==='windowblack'?'selected':''}>窗框黑 (Window Black)</option><option value="milkwhite" ${card.Type==='milkwhite'?'selected':''}>鮮乳白 (Milk White)</option><option value="grassgreen" ${card.Type==='grassgreen'?'selected':''}>青草綠 (Grass Green)</option><option disabled>--- 舊版選項 ---</option><option value="gold" ${card.Type==='gold'?'selected':''}>舊版金色</option><option value="blue" ${card.Type==='blue'?'selected':''}>舊版天藍</option><option value="green" ${card.Type==='green'?'selected':''}>舊版綠色</option><option value="orange" ${card.Type==='orange'?'selected':''}>舊版橘色</option><option value="purple" ${card.Type==='purple'?'selected':''}>舊版紫色</option><option value="red" ${card.Type==='red'?'selected':''}>舊版紅色</option><option value="teal" ${card.Type==='teal'?'selected':''}>舊版藍綠</option><option value="indigo" ${card.Type==='indigo'?'selected':''}>舊版靛藍</option><option value="cyan" ${card.Type==='cyan'?'selected':''}>舊版青色</option><option value="rose" ${card.Type==='rose'?'selected':''}>舊版玫瑰</option></select></div><div class="col-span-2"><label class="block text-xs font-bold text-gray-400">連結</label><input type="text" class="card-link w-full border rounded p-2 text-sm font-mono text-blue-600" value="${card.Link}"></div></div><button onclick="deleteCardItem(${index})" class="absolute top-2 right-2 text-red-400 hover:text-red-600 p-1"><i class="fas fa-trash"></i></button></div>`;
});
if (sortableCards) sortableCards.destroy(); sortableCards = Sortable.create(container, { handle: '.drag-handle', animation: 150, onEnd: () => collectDataFromEditors() });
}

        function renderContactsList() { /* (Keep existing logic) */ 
        function renderContactsList() { 
const officeContainer = document.getElementById('office-contact-editor'); const staffContainer = document.getElementById('staff-contacts-editor');
if(!officeContainer || !staffContainer) return; officeContainer.innerHTML = ''; staffContainer.innerHTML = '';
const office = currentData.contacts.find(c => c.Type === 'office') || { Name: '實習中心', Title: 'Office', Email: 'isac@thu.edu.tw', Description: '' };
officeContainer.innerHTML = `<div class="office-item bg-blue-50/50 p-6 rounded-xl border border-blue-100"><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label class="text-xs font-bold text-gray-400">單位名稱</label><input type="text" class="contact-name w-full border rounded p-2 font-bold" value="${office.Name}"></div><div><label class="text-xs font-bold text-gray-400">Email</label><input type="text" class="contact-email w-full border rounded p-2 font-mono" value="${office.Email}"></div><div class="hidden"><input type="text" class="contact-title" value="Office"></div><div class="col-span-2"><label class="text-xs font-bold text-gray-400">描述</label><input type="text" class="contact-desc w-full border rounded p-2" value="${office.Description}"></div></div></div>`;
const staff = currentData.contacts.filter(c => c.Type !== 'office');
            staff.forEach((c, index) => { staffContainer.innerHTML += `<div class="staff-item bg-white p-5 rounded-xl border border-gray-200 shadow-sm relative group" data-index="${index}"><div class="drag-handle absolute top-0 left-0 right-0 h-6 cursor-grab flex items-center justify-center hover:bg-gray-50 rounded-t-xl"><i class="fas fa-grip-lines text-gray-300"></i></div><div class="mt-4 space-y-2"><div class="flex gap-2"><div class="w-2/3"><label class="text-[10px] font-bold text-gray-400 block mb-1">姓名</label><input type="text" class="contact-name w-full border rounded p-1.5 font-bold text-sm" value="${c.Name}"></div><div class="w-1/3"><label class="text-[10px] font-bold text-gray-400 block mb-1">職稱</label><input type="text" class="contact-title w-full border rounded p-1.5 text-sm text-gray-500 text-center" value="${c.Title}"></div></div><div><label class="text-[10px] font-bold text-gray-400 block mb-1">Email</label><input type="text" class="contact-email w-full border rounded p-1.5 text-xs font-mono text-gray-500" value="${c.Email}"></div><div class="flex gap-2"><div class="w-1/2"><label class="text-[10px] font-bold text-gray-400 block mb-1">分機</label><input type="text" class="contact-phone w-full border rounded p-1.5 text-xs text-gray-500" value="${c.Phone||''}"></div><div class="w-1/2"><label class="text-[10px] font-bold text-gray-400 block mb-1">顏色</label><select class="contact-type w-full border rounded p-1.5 text-xs"><option value="blue" ${(!c.Type||c.Type==='blue')?'selected':''}>藍色</option><option value="gold" ${c.Type==='gold'?'selected':''}>金色</option><option value="green" ${c.Type==='green'?'selected':''}>綠色</option><option value="purple" ${c.Type==='purple'?'selected':''}>紫色</option><option value="orange" ${c.Type==='orange'?'selected':''}>橘色</option></select></div><input type="hidden" class="contact-desc" value="${c.Description||''}"></div></div><button onclick="deleteContactItem(${index})" class="absolute top-2 right-2 text-red-300 hover:text-red-500 p-1 opacity-0 group-hover:opacity-100 transition"><i class="fas fa-times-circle"></i></button></div>`; });
            staff.forEach((c, index) => { staffContainer.innerHTML += `<div class="staff-item bg-white p-5 rounded-xl border border-gray-200 shadow-sm relative group" data-index="${index}"><div class="drag-handle absolute top-0 left-0 right-0 h-6 cursor-grab flex items-center justify-center hover:bg-gray-50 rounded-t-xl"><i class="fas fa-grip-lines text-gray-300"></i></div><div class="mt-4 space-y-2"><div class="flex gap-2"><div class="w-2/3"><label class="text-[10px] font-bold text-gray-400 block mb-1">姓名</label><input type="text" class="contact-name w-full border rounded p-1.5 font-bold text-sm" value="${c.Name}"></div><div class="w-1/3"><label class="text-[10px] font-bold text-gray-400 block mb-1">職稱</label><input type="text" class="contact-title w-full border rounded p-1.5 text-sm text-gray-500 text-center" value="${c.Title}"></div></div><div><label class="text-[10px] font-bold text-gray-400 block mb-1">Email</label><input type="text" class="contact-email w-full border rounded p-1.5 text-xs font-mono text-gray-500" value="${c.Email}"></div><div class="flex gap-2"><div class="w-1/2"><label class="text-[10px] font-bold text-gray-400 block mb-1">分機</label><input type="text" class="contact-phone w-full border rounded p-1.5 text-xs text-gray-500" value="${c.Phone||''}"></div><div class="w-1/2"><label class="text-[10px] font-bold text-gray-400 block mb-1">顏色</label><select class="contact-type w-full border rounded p-1.5 text-xs"><option value="blue" ${(!c.Type||c.Type==='blue')?'selected':''}>預設藍</option><option value="thubluenew" ${c.Type==='thubluenew'?'selected':''}>東海藍</option><option value="glorygold" ${c.Type==='glorygold'?'selected':''}>榮耀金</option><option value="phoenixorange" ${c.Type==='phoenixorange'?'selected':''}>鳳凰橘</option><option value="brickred" ${c.Type==='brickred'?'selected':''}>磚瓦紅</option><option value="lapisyellow" ${c.Type==='lapisyellow'?'selected':''}>琉璃黃</option><option value="acaciagreen" ${c.Type==='acaciagreen'?'selected':''}>相思綠</option><option value="lakeblue" ${c.Type==='lakeblue'?'selected':''}>湖心藍</option><option value="concretegrey" ${c.Type==='concretegrey'?'selected':''}>清水灰</option><option value="windowblack" ${c.Type==='windowblack'?'selected':''}>窗框黑</option><option value="milkwhite" ${c.Type==='milkwhite'?'selected':''}>鮮乳白</option><option value="grassgreen" ${c.Type==='grassgreen'?'selected':''}>青草綠</option><option disabled>--- 舊版 ---</option><option value="gold" ${c.Type==='gold'?'selected':''}>舊版金色</option><option value="green" ${c.Type==='green'?'selected':''}>舊版綠色</option><option value="purple" ${c.Type==='purple'?'selected':''}>舊版紫色</option><option value="orange" ${c.Type==='orange'?'selected':''}>舊版橘色</option></select></div><input type="hidden" class="contact-desc" value="${c.Description||''}"></div></div><button onclick="deleteContactItem(${index})" class="absolute top-2 right-2 text-red-300 hover:text-red-500 p-1 opacity-0 group-hover:opacity-100 transition"><i class="fas fa-times-circle"></i></button></div>`; });
if (sortableStaff) sortableStaff.destroy(); sortableStaff = Sortable.create(staffContainer, { handle: '.drag-handle', animation: 150, onEnd: () => collectDataFromEditors() });
}
