<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>系所資料填報系統 (Department Data Entry)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- SheetJS for Excel Import/Export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#002E5D', secondary: '#C6A87C', success: '#219653', danger: '#DC2626', surface: '#ffffff', background: '#F8FAFC',
                    },
                    fontFamily: { sans: ['"Noto Sans TC"', 'sans-serif'] }
                }
            }
        }
    </script>
    <style>
        .custom-scroll::-webkit-scrollbar { width: 6px; height: 6px; } 
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        .input-stylish { width: 100%; border: 1px solid #e2e8f0; border-radius: 0.5rem; padding: 0.6rem 1rem; font-size: 0.95rem; transition: all 0.2s; background-color: #fff; }
        .input-stylish:focus { border-color: #002E5D; outline: none; box-shadow: 0 0 0 3px rgba(0, 46, 93, 0.1); }
        .input-stylish:disabled { background-color: #f1f5f9; color: #94a3b8; cursor: not-allowed; }

        .list-item { cursor: pointer; border-left: 3px solid transparent; transition: all 0.2s; }
        .list-item:hover { background-color: #f8fafc; }
        .list-item.active { background-color: #eff6ff; border-left-color: #002E5D; }
        .list-item.active .student-name { color: #002E5D; font-weight: bold; }

        .field-group { transition: all 0.3s ease; }
        .field-group.hidden-field { display: none; }
        
        .spinner { border: 3px solid rgba(0,46,93,0.1); border-radius: 50%; border-top: 3px solid #002E5D; width: 24px; height: 24px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="h-screen flex flex-col bg-background text-slate-700 overflow-hidden">

    <!-- Header -->
    <header class="h-16 bg-white border-b border-slate-200 flex items-center px-6 shadow-sm z-30 flex-shrink-0 justify-between">
        <div class="flex items-center gap-4">
            <img src="files/svg/THU-Logo.svg" class="h-8 w-auto" alt="Logo">
            <div>
                <h1 class="font-bold text-lg text-primary tracking-wide">系所資料填報系統</h1>
                <p class="text-[10px] text-slate-400">Department Data Entry System</p>
            </div>
        </div>
        <div class="flex items-center gap-3">
            <!-- Year Selector -->
            <div class="relative">
                <i class="fas fa-calendar-alt absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"></i>
                <select id="year-select" onchange="loadYearTemplate(this.value)" class="pl-9 pr-8 py-2 bg-slate-100 border-none rounded-lg text-sm font-bold text-slate-700 cursor-pointer focus:ring-2 focus:ring-primary outline-none appearance-none hover:bg-slate-200 transition">
                    <option value="">載入中...</option>
                </select>
                <i class="fas fa-chevron-down absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 text-xs pointer-events-none"></i>
            </div>

            <div class="h-6 w-px bg-slate-200 mx-2"></div>

            <!-- Action Buttons -->
            <label class="btn-import bg-white border border-slate-300 text-slate-600 hover:text-primary hover:border-primary px-4 py-2 rounded-lg text-sm font-bold shadow-sm transition flex items-center gap-2 cursor-pointer">
                <i class="fas fa-file-import"></i> 匯入名單 (Excel)
                <input type="file" id="file-upload" class="hidden" accept=".xlsx, .csv" onchange="handleFileUpload(event)">
            </label>
            <button onclick="exportData()" class="bg-success text-white px-4 py-2 rounded-lg text-sm font-bold hover:bg-emerald-700 transition shadow-sm flex items-center gap-2">
                <i class="fas fa-file-export"></i> 匯出填報結果
            </button>
        </div>
    </header>

    <!-- Main Layout -->
    <div class="flex-grow flex overflow-hidden">
        
        <!-- Sidebar: Student List -->
        <aside class="w-80 bg-white border-r border-slate-200 flex flex-col z-20 shadow-sm flex-shrink-0">
            <div class="p-4 border-b border-slate-100 bg-slate-50">
                <div class="relative">
                    <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"></i>
                    <input type="text" id="search-student" oninput="filterStudentList(this.value)" placeholder="搜尋姓名或學號..." class="w-full pl-9 pr-3 py-2 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-primary outline-none">
                </div>
                <div class="flex justify-between items-center mt-2 text-xs text-slate-500">
                    <span>學生列表</span>
                    <span id="student-count" class="bg-slate-200 px-2 py-0.5 rounded-full text-slate-600 font-bold">0</span>
                </div>
            </div>
            
            <div id="student-list" class="flex-grow overflow-y-auto custom-scroll p-2 space-y-1">
                <!-- Student Items will be injected here -->
                <div class="p-8 text-center text-slate-400 text-sm">
                    <i class="fas fa-arrow-up mb-2 text-xl block"></i>
                    請先從上方匯入 Excel 名單
                </div>
            </div>
        </aside>

        <!-- Main Form Area -->
        <main class="flex-grow bg-slate-50 overflow-y-auto custom-scroll relative flex flex-col" id="main-content">
            
            <!-- Empty State -->
            <div id="form-empty-state" class="flex flex-col items-center justify-center h-full text-slate-400">
                <div class="w-20 h-20 bg-white rounded-full flex items-center justify-center mb-4 text-3xl shadow-sm border border-slate-100">
                    <i class="fas fa-user-edit text-slate-300"></i>
                </div>
                <p>請從左側選擇一位學生開始填報</p>
            </div>

            <!-- Dynamic Form -->
            <div id="form-container" class="hidden max-w-5xl mx-auto w-full p-8 pb-20">
                
                <!-- Student Header -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200 mb-6 flex justify-between items-center sticky top-0 z-10">
                    <div>
                        <h2 class="text-xl font-bold text-slate-800 flex items-center gap-2">
                            <span id="header-name">學生姓名</span>
                            <span id="header-id" class="text-sm font-mono bg-slate-100 text-slate-500 px-2 py-1 rounded">ID</span>
                        </h2>
                        <p class="text-xs text-slate-400 mt-1">請依據實際實習狀況填寫以下欄位。</p>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="prevStudent()" class="px-3 py-2 border border-slate-200 rounded-lg hover:bg-slate-50 text-slate-500" title="上一位"><i class="fas fa-chevron-left"></i></button>
                        <button onclick="nextStudent()" class="px-3 py-2 border border-slate-200 rounded-lg hover:bg-slate-50 text-slate-500" title="下一位"><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>

                <!-- Form Fields Injection Point -->
                <div id="dynamic-form-fields" class="space-y-8"></div>

            </div>
        </main>
    </div>

    <!-- Notification Modal -->
    <div id="toast" class="fixed bottom-5 right-5 bg-slate-800 text-white px-6 py-3 rounded-lg shadow-lg transform translate-y-20 opacity-0 transition-all duration-300 z-50 flex items-center gap-3">
        <i id="toast-icon" class="fas fa-info-circle"></i>
        <span id="toast-msg">Notification</span>
    </div>

    <script>
        // --- Global Data Stores ---
        let globalConfig = {};       // config.json
        let currentYearConfig = {};  // year_XXX_templates.json
        let departmentData = [];     // data_departments.json
        let deptMasterData = {};     // data_dept_master.json
        
        let allStudents = [];        // Loaded student data (Array of Objects)
        let currentStudentIdx = -1;  // Currently selected index
        let activeYear = "";         // Currently selected academic year

        // --- Initialization ---
        window.onload = async function() {
            try {
                // 1. Load basic configs (Relative paths)
                const [cfgRes, deptRes, masterRes] = await Promise.all([
                    fetch('config.json').then(r => r.ok ? r.json() : {}),
                    fetch('data_departments.json').then(r => r.ok ? r.json() : []),
                    fetch('data_dept_master.json').then(r => r.ok ? r.json() : {})
                ]);

                globalConfig = cfgRes;
                departmentData = deptRes;
                deptMasterData = masterRes;

                // 2. Setup Year Selector
                const yearSelect = document.getElementById('year-select');
                yearSelect.innerHTML = '';
                
                if (globalConfig.academicYears && globalConfig.academicYears.length > 0) {
                    globalConfig.academicYears.sort((a,b) => b.year.localeCompare(a.year));
                    globalConfig.academicYears.forEach(y => {
                        const opt = document.createElement('option');
                        opt.value = y.year;
                        opt.innerText = `${y.year} 學年度`;
                        yearSelect.appendChild(opt);
                    });
                    
                    // Select default
                    const def = globalConfig.academicYears.find(y => y.isDefault) || globalConfig.academicYears[0];
                    yearSelect.value = def.year;
                    loadYearTemplate(def.year);
                } else {
                    yearSelect.innerHTML = '<option>無設定</option>';
                }

            } catch (e) {
                console.error("Init failed", e);
                showToast('error', '系統初始化失敗，請檢查設定檔路徑。');
            }
        };

        // --- Core Logic: Load Template ---
        async function loadYearTemplate(year) {
            if(!year) return;
            activeYear = year;
            showToast('info', `載入 ${year} 學年度設定中...`);
            
            try {
                const res = await fetch(`year_templates/year_${year}_templates.json?t=${Date.now()}`);
                if (!res.ok) throw new Error("Template not found");
                currentYearConfig = await res.json();
                
                // If a student is currently selected, re-render the form with new template
                if (currentStudentIdx !== -1) {
                    renderStudentForm(currentStudentIdx);
                }
                showToast('success', `已切換至 ${year} 學年度`);
            } catch (e) {
                console.error(e);
                showToast('error', `無法讀取 ${year} 學年度模板`);
            }
        }

        // --- File Import ---
        function handleFileUpload(e) {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(evt) {
                try {
                    const data = new Uint8Array(evt.target.result);
                    const workbook = XLSX.read(data, {type: 'array'});
                    const firstSheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[firstSheetName];
                    
                    // Parse to JSON
                    const rawData = XLSX.utils.sheet_to_json(worksheet, {defval: ""});
                    
                    if (rawData.length === 0) {
                        showToast('error', '檔案內容為空');
                        return;
                    }

                    // Map Excel data to our internal structure
                    // We assume Excel headers roughly match our Field Labels or IDs. 
                    // For now, we store the raw row and map on demand or let the user fill gaps.
                    allStudents = rawData; 
                    currentStudentIdx = -1;

                    renderStudentList();
                    showToast('success', `成功匯入 ${allStudents.length} 筆資料`);
                    
                    // Reset file input
                    e.target.value = ''; 

                } catch (err) {
                    console.error(err);
                    showToast('error', '檔案解析失敗，請確認格式');
                }
            };
            reader.readAsArrayBuffer(file);
        }

        // --- Render Sidebar ---
        function renderStudentList(filterText = "") {
            const listEl = document.getElementById('student-list');
            listEl.innerHTML = '';
            
            let count = 0;
            allStudents.forEach((student, idx) => {
                // Try to find Name and ID columns (fuzzy match)
                const name = student['姓名'] || student['student_name'] || student['name'] || `學生 ${idx+1}`;
                const id = student['學號'] || student['student_id'] || student['id'] || '#';
                
                // Filter logic
                if (filterText) {
                    const txt = (name + id).toLowerCase();
                    if (!txt.includes(filterText.toLowerCase())) return;
                }

                const div = document.createElement('div');
                div.className = `list-item p-3 border-b border-slate-100 ${idx === currentStudentIdx ? 'active' : ''}`;
                div.onclick = () => selectStudent(idx);
                div.innerHTML = `
                    <div class="flex justify-between items-center">
                        <span class="text-sm font-medium text-slate-700 student-name truncate mr-2">${name}</span>
                        <span class="text-xs font-mono text-slate-400 bg-slate-100 px-1.5 rounded">${id}</span>
                    </div>
                `;
                listEl.appendChild(div);
                count++;
            });

            document.getElementById('student-count').innerText = count;
        }

        function filterStudentList(val) {
            renderStudentList(val);
        }

        function selectStudent(idx) {
            currentStudentIdx = idx;
            renderStudentList(document.getElementById('search-student').value); // Re-render to update active state
            renderStudentForm(idx);
        }
        
        function prevStudent() {
            if (currentStudentIdx > 0) selectStudent(currentStudentIdx - 1);
        }
        function nextStudent() {
            if (currentStudentIdx < allStudents.length - 1) selectStudent(currentStudentIdx + 1);
        }

        // --- Render Form (One Student One Page) ---
        function renderStudentForm(idx) {
            const container = document.getElementById('dynamic-form-fields');
            const student = allStudents[idx];
            
            if (!student || !currentYearConfig.fields) return;

            // Update Header
            const name = student['姓名'] || student['student_name'] || student['name'] || '未知姓名';
            const id = student['學號'] || student['student_id'] || student['id'] || '無學號';
            document.getElementById('header-name').innerText = name;
            document.getElementById('header-id').innerText = id;

            // Show Form, Hide Empty State
            document.getElementById('form-empty-state').classList.add('hidden');
            document.getElementById('form-container').classList.remove('hidden');

            container.innerHTML = ''; // Clear previous fields

            // Group Fields by Category
            const categories = globalConfig.templateCategories || [];
            const groupedFields = {};
            
            // Init groups
            categories.forEach(c => groupedFields[c.id] = { meta: c, fields: [] });
            groupedFields['uncategorized'] = { meta: {id:'uncategorized', name:'其他資訊'}, fields: [] };

            currentYearConfig.fields.forEach(f => {
                const catId = (f.category && groupedFields[f.category]) ? f.category : 'uncategorized';
                groupedFields[catId].fields.push(f);
            });

            // Render Groups
            // Sort categories by order
            const sortedCatIds = Object.keys(groupedFields).sort((a,b) => (groupedFields[a].meta.order || 99) - (groupedFields[b].meta.order || 99));

            sortedCatIds.forEach(catId => {
                const group = groupedFields[catId];
                if (group.fields.length === 0) return;

                // Create Section
                const section = document.createElement('div');
                section.className = "bg-white p-6 rounded-xl shadow-sm border border-slate-200";
                section.innerHTML = `
                    <h3 class="text-md font-bold text-primary mb-4 pb-2 border-b border-slate-100 flex items-center gap-2">
                        <i class="fas fa-layer-group text-secondary"></i> ${group.meta.name}
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="cat-grid-${catId}"></div>
                `;
                container.appendChild(section);
                
                const grid = section.querySelector(`#cat-grid-${catId}`);
                
                // Sort fields by order
                group.fields.sort((a,b) => (a.order||0) - (b.order||0));

                group.fields.forEach(field => {
                    grid.appendChild(createFieldInput(field, student));
                });
            });

            // Run Logic Check Immediately
            evaluateAllLogic();
        }

        // --- Field Creation Helper ---
        function createFieldInput(field, studentData) {
            const wrapper = document.createElement('div');
            wrapper.className = "field-group";
            wrapper.id = `wrapper-${field.id}`;
            wrapper.dataset.fieldId = field.id; // Helper for logic

            // Attempt to retrieve existing value from imported data
            // Priority: ID match -> Label match
            let initialVal = studentData[field.id] !== undefined ? studentData[field.id] : 
                             (studentData[field.label] !== undefined ? studentData[field.label] : "");

            const requiredMark = field.required ? '<span class="text-red-500 ml-1">*</span>' : '';
            const helpText = field.description ? `<p class="text-xs text-slate-400 mt-1"><i class="fas fa-info-circle mr-1"></i>${field.description}</p>` : '';

            let inputHtml = '';
            
            // --- Input Type Logic ---
            if (field.type === 'single_select' || field.type === 'list') {
                const opts = field.options || [];
                const optionsHtml = opts.map(o => `<option value="${o}" ${o==initialVal?'selected':''}>${o}</option>`).join('');
                inputHtml = `
                    <select id="field-${field.id}" onchange="updateValue('${field.id}', this.value)" class="input-stylish cursor-pointer">
                        <option value="">請選擇...</option>
                        ${optionsHtml}
                    </select>
                `;
            } 
            else if (field.type === 'college') {
                const optionsHtml = departmentData.map(c => {
                    const name = c.short_name || c.name;
                    return `<option value="${c.id}" ${c.id==initialVal?'selected':''}>${name}</option>`;
                }).join('');
                inputHtml = `
                    <select id="field-${field.id}" onchange="updateValue('${field.id}', this.value)" class="input-stylish cursor-pointer">
                        <option value="">請選擇學院...</option>
                        ${optionsHtml}
                    </select>
                `;
            }
            else if (field.type === 'department') {
                // Initial render puts ALL departments. Logic will filter them later.
                let optionsHtml = '';
                departmentData.forEach(col => {
                    col.departments.forEach(deptId => {
                        const m = deptMasterData[deptId];
                        const name = m ? (m.short_name || m.name) : deptId;
                        optionsHtml += `<option value="${deptId}" data-college="${col.id}" ${deptId==initialVal?'selected':''}>${name}</option>`;
                    });
                });
                inputHtml = `
                    <select id="field-${field.id}" onchange="updateValue('${field.id}', this.value)" class="input-stylish cursor-pointer" data-original-options="true">
                        <option value="">請選擇系所...</option>
                        ${optionsHtml}
                    </select>
                `;
            }
            else if (field.type === 'date') {
                // Convert ROC if needed? Simplification: Use text or standard date input
                inputHtml = `<input type="date" id="field-${field.id}" value="${initialVal}" onchange="updateValue('${field.id}', this.value)" class="input-stylish">`;
            }
            else if (field.type === 'number') {
                inputHtml = `<input type="number" id="field-${field.id}" value="${initialVal}" oninput="updateValue('${field.id}', this.value)" class="input-stylish" step="${field.decimal ? '0.01' : '1'}">`;
            }
            else {
                // Text, Address, etc.
                const maxLen = field.maxLen ? `maxlength="${field.maxLen}"` : '';
                inputHtml = `<input type="text" id="field-${field.id}" value="${initialVal}" oninput="updateValue('${field.id}', this.value)" class="input-stylish" ${maxLen}>`;
            }

            wrapper.innerHTML = `
                <label class="block text-sm font-bold text-slate-700 mb-1">${field.label}${requiredMark}</label>
                ${inputHtml}
                ${helpText}
            `;
            
            // Cache original options for filtering
            setTimeout(() => {
                const sel = wrapper.querySelector('select');
                if(sel) sel.dataset.original = sel.innerHTML;
            }, 0);

            return wrapper;
        }

        // --- Data Update & Logic Engine ---
        
        function updateValue(fieldId, value) {
            // 1. Update Data Model
            if (currentStudentIdx !== -1) {
                allStudents[currentStudentIdx][fieldId] = value;
            }
            
            // 2. Trigger Logic Evaluation
            evaluateAllLogic();
        }

        function evaluateAllLogic() {
            // This function runs client-side to simulate the logic defined in admin.html
            
            const fields = currentYearConfig.fields || [];
            
            // A. Visibility Logic (Show/Hide)
            fields.forEach(f => {
                if (f.visibilityRule && f.visibilityRule.dep) {
                    const rule = f.visibilityRule;
                    const depVal = getValue(rule.dep);
                    const wrapper = document.getElementById(`wrapper-${f.id}`);
                    
                    if (wrapper) {
                        let isVisible = true;
                        const match = (depVal === rule.val);
                        
                        if (rule.action === 'show') isVisible = match;
                        else if (rule.action === 'hide') isVisible = !match;
                        
                        if (isVisible) wrapper.classList.remove('hidden-field');
                        else wrapper.classList.add('hidden-field');
                    }
                }
            });

            // B. Filter Logic (Dropdown Options)
            fields.forEach(f => {
                // 1. Explicit Filter Rules from Config
                if (f.filterRules && f.filterRules.length > 0) {
                    applyFilterRules(f);
                }
                // 2. Implicit Department Logic (College -> Department)
                if (f.type === 'department') {
                    applyDepartmentLogic(f);
                }
            });
        }

        function getValue(fieldId) {
            // Helper to get current value from input (DOM source of truth for unsaved edits)
            const el = document.getElementById(`field-${fieldId}`);
            return el ? el.value : '';
        }

        function applyFilterRules(field) {
            const select = document.getElementById(`field-${field.id}`);
            if (!select) return;

            // Restore original first
            if (select.dataset.original) {
                const oldVal = select.value;
                select.innerHTML = select.dataset.original;
                select.value = oldVal;
            }

            // Find matching rule
            let activeRule = null;
            for (const rule of field.filterRules) {
                if (getValue(rule.dep) === rule.val) {
                    activeRule = rule;
                    break;
                }
            }

            if (activeRule && activeRule.limitTo) {
                const allowed = activeRule.limitTo;
                Array.from(select.options).forEach(opt => {
                    if (opt.value === "") return; // keep placeholder
                    if (!allowed.includes(opt.value)) {
                        opt.remove();
                    }
                });
                // If current value is invalid, clear it
                if (!allowed.includes(select.value)) select.value = "";
            }
        }

        function applyDepartmentLogic(field) {
            // Guess parent college field. Usually 'student_college' or 'offering_college'
            // We look for a field with type 'college' in the same category or standard naming
            let parentId = null;
            if (field.id.includes('student')) parentId = 'student_college';
            else if (field.id.includes('offering') || field.id.includes('course')) parentId = 'offering_college';
            
            // Fallback: Check if config explicitly defined a dependency in filterRules (optional)
            
            if (!parentId) return;

            const collegeVal = getValue(parentId);
            const select = document.getElementById(`field-${field.id}`);
            if (!select || !select.dataset.original) return;

            const oldVal = select.value;
            select.innerHTML = select.dataset.original; // Restore all departments

            if (collegeVal) {
                // Filter by data-college attribute
                Array.from(select.options).forEach(opt => {
                    if (opt.value === "") return;
                    if (opt.dataset.college !== collegeVal) {
                        opt.remove();
                    }
                });
            }
            
            // Attempt to keep value if still valid
            if (Array.from(select.options).some(o => o.value === oldVal)) {
                select.value = oldVal;
            } else {
                select.value = "";
            }
        }

        // --- Export ---
        function exportData() {
            if (allStudents.length === 0) return showToast('error', '沒有資料可匯出');
            
            // Create workbook
            const worksheet = XLSX.utils.json_to_sheet(allStudents);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, "填報資料");
            
            // Save file
            const filename = `填報資料_${activeYear}_${new Date().toISOString().slice(0,10)}.xlsx`;
            XLSX.writeFile(workbook, filename);
            showToast('success', '匯出成功！');
        }

        // --- UI Utils ---
        function showToast(type, msg) {
            const el = document.getElementById('toast');
            const icon = document.getElementById('toast-icon');
            const txt = document.getElementById('toast-msg');
            
            el.className = `fixed bottom-5 right-5 px-6 py-3 rounded-lg shadow-lg transform transition-all duration-300 z-50 flex items-center gap-3 ${type === 'error' ? 'bg-red-600' : (type === 'success' ? 'bg-emerald-600' : 'bg-slate-800')} text-white translate-y-0 opacity-100`;
            
            icon.className = type === 'success' ? 'fas fa-check-circle' : (type === 'error' ? 'fas fa-exclamation-triangle' : 'fas fa-info-circle');
            txt.innerText = msg;

            setTimeout(() => {
                el.classList.add('translate-y-20', 'opacity-0');
            }, 3000);
        }

    </script>
</body>
</html>
